[REDACTED: Full file content, including all new and updated tests, as in the workspace]